(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"9hXf":function(t,e,n){"use strict";n.r(e),n.d(e,"SignalrnewsModule",(function(){return dt}));var i=n("ofXK"),s=n("tyNb"),o=n("l7P3");const c=Object(o.g)("[news] JOIN_GROUP",Object(o.l)()),r=Object(o.g)("[news] JOIN_GROUP_Complete",Object(o.l)()),u=Object(o.g)("[news] RECEIVED_GROUP_JOIN",Object(o.l)()),a=Object(o.g)("[news] LEAVE_GROUP",Object(o.l)()),b=Object(o.g)("[news] LEAVE_GROUP_Complete",Object(o.l)()),h=Object(o.g)("[news] RECEIVED_GROUP_LEFT",Object(o.l)()),l=Object(o.g)("[news] SEND_NEWS_ITEM",Object(o.l)()),d=Object(o.g)("[news] SEND_NEWS_ITEM_COMPLETE",Object(o.l)()),p=Object(o.g)("[news] GET_ALL_GROUPS"),g=Object(o.g)("[news] GET_ALL_GROUPS_Success",Object(o.l)()),f=Object(o.g)("[news] GET_ALL_GROUPS_Failure",Object(o.l)()),O=Object(o.g)("[news] receivedGroupHistory",Object(o.l)()),m=Object(o.g)("[news] receivedItemAction",Object(o.l)());class j{constructor(t,e,n,i){this.header=t,this.newsText=e,this.author=n,this.newsGroup=i}}var w=n("lJxs"),v=n("fXoL");const C=function(){var t={EntitiesOnly:0,Both:1,None:2};return t[t.EntitiesOnly]="EntitiesOnly",t[t.Both]="Both",t[t.None]="None",t}();function I(t){return function(e,n){const i={ids:[...n.ids],entities:Object.assign({},n.entities)},s=t(e,i);return s===C.Both?Object.assign({},n,i):s===C.EntitiesOnly?Object.assign(Object.assign({},n),{entities:i.entities}):n}}function T(t,e){const n=e(t);return Object(v.Y)()&&void 0===n&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",t,"The `selectId` implementation:",e.toString()),n}function y(t){function e(e,n){const i=T(e,t);return i in n.entities?C.None:(n.ids.push(i),n.entities[i]=e,C.Both)}function n(t,n){let i=!1;for(const s of t)i=e(s,n)!==C.None||i;return i?C.Both:C.None}function i(t,e){return e.ids=[],e.entities={},n(t,e),C.Both}function s(t,e){const n=(t instanceof Array?t:e.ids.filter(n=>t(e.entities[n]))).filter(t=>t in e.entities).map(t=>delete e.entities[t]).length>0;return n&&(e.ids=e.ids.filter(t=>t in e.entities)),n?C.Both:C.None}function o(t,e){return c([t],e)}function c(e,n){const i={};return(e=e.filter(t=>t.id in n.entities)).length>0?e.filter(e=>function(e,n,i){const s=Object.assign({},i.entities[n.id],n.changes),o=T(s,t),c=o!==n.id;return c&&(e[n.id]=o,delete i.entities[n.id]),i.entities[o]=s,c}(i,e,n)).length>0?(n.ids=n.ids.map(t=>i[t]||t),C.Both):C.EntitiesOnly:C.None}function r(e,i){const s=[],o=[];for(const n of e){const e=T(n,t);e in i.entities?o.push({id:e,changes:n}):s.push(n)}const r=c(o,i),u=n(s,i);switch(!0){case u===C.None&&r===C.None:return C.None;case u===C.Both||r===C.Both:return C.Both;default:return C.EntitiesOnly}}return{removeAll:function(t){return Object.assign({},t,{ids:[],entities:{}})},addOne:I(e),addMany:I(n),addAll:I(i),setAll:I(i),setOne:I((function(e,n){const i=T(e,t);return i in n.entities?(n.entities[i]=e,C.EntitiesOnly):(n.ids.push(i),n.entities[i]=e,C.Both)})),updateOne:I(o),updateMany:I(c),upsertOne:I((function(t,e){return r([t],e)})),upsertMany:I(r),removeOne:I((function(t,e){return s([t],e)})),removeMany:I(s),map:I((function(t,e){return c(e.ids.reduce((n,i)=>{const s=t(e.entities[i]);return s!==e.entities[i]&&n.push({id:i,changes:s}),n},[]).filter(({id:t})=>t in e.entities),e)})),mapOne:I((function({map:t,id:e},n){const i=n.entities[e];return i?o({id:e,changes:t(i)},n):C.None}))}}const U="newses",G=function(t={}){const{selectId:e,sortComparer:n}=Object.assign({sortComparer:!1,selectId:t=>t.id},t),i={getInitialState:function(t={}){return Object.assign({ids:[],entities:{}},t)}},s={getSelectors:function(t){const e=t=>t.ids,n=t=>t.entities,i=Object(o.j)(e,n,(t,e)=>t.map(t=>e[t])),s=Object(o.j)(e,t=>t.length);return t?{selectIds:Object(o.j)(t,e),selectEntities:Object(o.j)(t,n),selectAll:Object(o.j)(t,i),selectTotal:Object(o.j)(t,s)}:{selectIds:e,selectEntities:n,selectAll:i,selectTotal:s}}},c=n?function(t,e){const{removeOne:n,removeMany:i,removeAll:s}=y(t);function o(t,e){return c([t],e)}function c(e,n){const i=e.filter(e=>!(T(e,t)in n.entities));return 0===i.length?C.None:(h(i,n),C.Both)}function r(t,e){return e.entities={},e.ids=[],c(t,e),C.Both}function u(t,e){return a([t],e)}function a(e,n){const i=[],s=e.filter(e=>function(e,n,i){if(!(n.id in i.entities))return!1;const s=Object.assign({},i.entities[n.id],n.changes),o=T(s,t);return delete i.entities[n.id],e.push(s),o!==n.id}(i,e,n)).length>0;if(0===i.length)return C.None;{const t=n.ids,e=[];return n.ids=n.ids.filter((t,i)=>t in n.entities||(e.push(i),!1)),h(i,n),!s&&e.every(e=>n.ids[e]===t[e])?C.EntitiesOnly:C.Both}}function b(e,n){const i=[],s=[];for(const c of e){const e=T(c,t);e in n.entities?s.push({id:e,changes:c}):i.push(c)}const o=a(s,n),r=c(i,n);switch(!0){case r===C.None&&o===C.None:return C.None;case r===C.Both||o===C.Both:return C.Both;default:return C.EntitiesOnly}}function h(n,i){n.sort(e);const s=[];let o=0,c=0;for(;o<n.length&&c<i.ids.length;){const r=n[o],u=T(r,t),a=i.ids[c];e(r,i.entities[a])<=0?(s.push(u),o++):(s.push(a),c++)}i.ids=s.concat(o<n.length?n.slice(o).map(t):i.ids.slice(c)),n.forEach((e,n)=>{i.entities[t(e)]=e})}return{removeOne:n,removeMany:i,removeAll:s,addOne:I(o),updateOne:I(u),upsertOne:I((function(t,e){return b([t],e)})),addAll:I(r),setAll:I(r),setOne:I((function(e,n){const i=T(e,t);return i in n.entities?(n.ids=n.ids.filter(t=>t!==i),h([e],n),C.Both):o(e,n)})),addMany:I(c),updateMany:I(a),upsertMany:I(b),map:I((function(t,e){return a(e.ids.reduce((n,i)=>{const s=t(e.entities[i]);return s!==e.entities[i]&&n.push({id:i,changes:s}),n},[]),e)})),mapOne:I((function({map:t,id:e},n){const i=n.entities[e];return i?u({id:e,changes:t(i)},n):C.None}))}}(e,n):y(e);return Object.assign(Object.assign(Object.assign({selectId:e,sortComparer:n},i),s),c)}({selectId:t=>t.id}),E=G.getInitialState({groups:[]}),k=Object(o.i)(E,Object(o.k)(g,(t,e)=>Object.assign(Object.assign({},t),{groups:e.groups})),Object(o.k)(u,(t,e)=>{let n=t.groups.indexOf(e.group)>-1?t.groups:t.groups.concat(e.group);return Object.assign(Object.assign({},t),{groups:n})}),Object(o.k)(m,(t,e)=>G.addOne(e.newsItem,t)),Object(o.k)(O,(t,e)=>(console.info("inside reducer: ",e.newsItems),G.setAll(e.newsItems,t))),Object(o.k)(h,(t,e)=>{const n=[];for(const i of t.groups)i!==e.group&&n.push(i);return console.log(n),Object.assign(Object.assign({},t),{groups:n})})),{selectAll:A}=G.getSelectors(),N=Object(o.h)(U),S=Object(o.j)(N,A),M=Object(o.j)(N,t=>t.groups);var B=n("dNgK"),L=n("kmnG"),_=n("d3UM"),P=n("3Pt+"),x=n("f0Cb"),R=n("qFsG"),$=n("bTqV"),F=n("FKr1");function J(t,e){if(1&t&&(v.Ub(0,"mat-option",12),v.Cc(1),v.Tb()),2&t){const t=e.$implicit;v.kc("value",t),v.Cb(1),v.Ec("",t," ")}}function Y(t,e){if(1&t&&(v.Ub(0,"tr"),v.Ub(1,"td"),v.Cc(2),v.Tb(),v.Ub(3,"td"),v.Cc(4),v.Tb(),v.Ub(5,"td"),v.Cc(6),v.Tb(),v.Ub(7,"td"),v.Cc(8),v.Tb(),v.Ub(9,"td"),v.Cc(10),v.Tb(),v.Tb()),2&t){const t=e.$implicit,n=e.index;v.Cb(2),v.Dc(n+1),v.Cb(2),v.Dc(t.header),v.Cb(2),v.Dc(t.newsText),v.Cb(2),v.Dc(t.author),v.Cb(2),v.Dc(t.newsGroup)}}function D(t,e){if(1&t&&(v.Sb(0),v.Ub(1,"div",0),v.Ub(2,"div",14),v.Ub(3,"table",15),v.Ub(4,"thead"),v.Ub(5,"tr"),v.Ub(6,"th"),v.Cc(7,"#"),v.Tb(),v.Ub(8,"th"),v.Cc(9,"header"),v.Tb(),v.Ub(10,"th"),v.Cc(11,"Text"),v.Tb(),v.Ub(12,"th"),v.Cc(13,"Author"),v.Tb(),v.Ub(14,"th"),v.Cc(15,"Group"),v.Tb(),v.Tb(),v.Tb(),v.Ub(16,"tbody"),v.Ac(17,Y,11,5,"tr",16),v.Tb(),v.Tb(),v.Tb(),v.Tb(),v.Rb()),2&t){const t=v.ec().ngIf;v.Cb(17),v.kc("ngForOf",t)}}function K(t,e){1&t&&(v.Ub(0,"div",0),v.Ub(1,"span"),v.Cc(2,"No news items"),v.Tb(),v.Tb())}function V(t,e){if(1&t&&(v.Sb(0),v.Ac(1,D,18,1,"ng-container",11),v.Ac(2,K,3,0,"div",13),v.Rb()),2&t){const t=e.ngIf;v.Cb(1),v.kc("ngIf",t.length),v.Cb(1),v.kc("ngIf",0==(null==t?null:t.length))}}let q=(()=>{class t{constructor(t,e,n){this.store=t,this.snackBar=e,this.route=n,this.group="IT",this.author="",this.newsItem=new j("","",this.author,this.group)}ngOnInit(){this.newsItems$=this.store.select(S),this.groups$=this.route.data.pipe(Object(w.a)(t=>t.groups))}joinGroup(){this.store.dispatch(c({group:this.group}))}leaveGroup(){this.store.dispatch(a({group:this.group}))}sendNewsItemToGroup(){this.store.dispatch(l({newsItem:this.newsItem})),this.newsItem.header="",this.newsItem.newsText=""}}return t.\u0275fac=function(e){return new(e||t)(v.Ob(o.b),v.Ob(B.b),v.Ob(s.a))},t.\u0275cmp=v.Ib({type:t,selectors:[["app-news"]],decls:30,vars:11,consts:[[1,"row"],[1,"col-sm-9","col-md-4"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-success","col-sm-9","col-md-2","m-auto",3,"click"],[1,"btn","btn-danger","col-sm-9","col-md-2","m-auto",3,"click"],[1,"form-horizontal",2,"padding","10px 0",3,"ngSubmit"],["newsItemForm","ngForm"],["matInput","","type","text","name","header","placeholder","your header...","required","",3,"ngModel","ngModelChange"],["matInput","","type","text","name","newsText","placeholder","your newsText...","required","",3,"ngModel","ngModelChange"],["type","submit","mat-raised-button","",1,"col-sm-9","col-md-2",3,"disabled"],[4,"ngIf"],[3,"value"],["class","row",4,"ngIf"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"]],template:function(t,e){if(1&t&&(v.Ub(0,"div"),v.Ub(1,"div",0),v.Ub(2,"mat-form-field",1),v.Ub(3,"mat-label"),v.Cc(4,"Group"),v.Tb(),v.Ub(5,"mat-select",2),v.ac("ngModelChange",(function(t){return e.group=t})),v.Ac(6,J,2,2,"mat-option",3),v.fc(7,"async"),v.Tb(),v.Tb(),v.Ub(8,"button",4),v.ac("click",(function(){return e.joinGroup()})),v.Cc(9,"Join"),v.Tb(),v.Ub(10,"button",5),v.ac("click",(function(){return e.leaveGroup()})),v.Cc(11,"Leave"),v.Tb(),v.Tb(),v.Tb(),v.Pb(12,"br"),v.Pb(13,"mat-divider"),v.Pb(14,"br"),v.Ub(15,"form",6,7),v.ac("ngSubmit",(function(){return e.sendNewsItemToGroup()})),v.Ub(17,"div",0),v.Ub(18,"mat-form-field",1),v.Ub(19,"input",8),v.ac("ngModelChange",(function(t){return e.newsItem.header=t})),v.Tb(),v.Tb(),v.Ub(20,"mat-form-field",1),v.Ub(21,"input",9),v.ac("ngModelChange",(function(t){return e.newsItem.newsText=t})),v.Tb(),v.Tb(),v.Ub(22,"button",10),v.Cc(23),v.Tb(),v.Tb(),v.Tb(),v.Pb(24,"br"),v.Pb(25,"br"),v.Pb(26,"mat-divider"),v.Pb(27,"br"),v.Ac(28,V,3,2,"ng-container",11),v.fc(29,"async")),2&t){const t=v.qc(16);v.Cb(5),v.kc("ngModel",e.group),v.Cb(1),v.kc("ngForOf",v.gc(7,7,e.groups$)),v.Cb(13),v.kc("ngModel",e.newsItem.header),v.Cb(2),v.kc("ngModel",e.newsItem.newsText),v.Cb(1),v.kc("disabled",!t.valid),v.Cb(1),v.Ec(" Send News to: ",e.group," "),v.Cb(5),v.kc("ngIf",v.gc(29,9,e.newsItems$))}},directives:[L.c,L.f,_.a,P.m,P.p,i.m,x.a,P.t,P.n,P.o,R.b,P.c,P.r,$.b,i.n,F.n],pipes:[i.b],styles:[""]}),t})();var X=n("vkgz"),z=n("pLZG"),H=n("SxV6"),W=n("nYR2");let Z=(()=>{class t{constructor(t){this.store=t,this.isBusy=!1}resolve(t,e){return this.store.pipe(Object(o.m)(M),Object(X.a)(t=>{this.isBusy||0!=t.length||(this.isBusy=!0,this.store.dispatch(p()))}),Object(z.a)(t=>t.length>0),Object(H.a)(),Object(W.a)(()=>this.isBusy=!1))}}return t.\u0275fac=function(e){return new(e||t)(v.Yb(o.b))},t.\u0275prov=v.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Q=n("7Vn+");const tt=[{path:"",component:q,resolve:{groups:Z},canActivate:[(()=>{class t{constructor(t){this.authService=t}canActivate(t,e){return this.checkLogin(e.url)}canActivateChild(t,e){return this.canActivate(t,e)}canLoad(t,e){return this.checkLogin("/"+t.path)}checkLogin(t){return this.authService.redirectUrl=t,this.authService.isAuthenticated$.pipe(Object(w.a)(t=>!!t||(this.authService.login(),!1)))}}return t.\u0275fac=function(e){return new(e||t)(v.Yb(Q.a))},t.\u0275prov=v.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()]}];let et=(()=>{class t{}return t.\u0275mod=v.Mb({type:t}),t.\u0275inj=v.Lb({factory:function(e){return new(e||t)},imports:[[s.j.forChild(tt)],s.j]}),t})();var nt=n("9jGm"),it=n("LRne"),st=n("eIep"),ot=n("bOdf"),ct=n("JIr8"),rt=n("AytR"),ut=n("Gpoy"),at=n("tk/3");let bt=(()=>{class t{constructor(t,e,n){this.http=t,this.authService=e,this.store=n,this.hubConnection=(new ut.a).withUrl(rt.a.serverUrl+"/news",{accessTokenFactory:()=>this.authService.token}).configureLogging(rt.a.production?ut.b.None:ut.b.Information).build(),this.registerEvents(),this.connect()}connect(){this.hubConnection.start().then(()=>console.log("Connection started")).catch(t=>console.log("Error while starting connection: ",t))}disconnect(){this.hubConnection.stop().catch(t=>console.log("Error while stopping connection: ",t))}registerEvents(){this.hubConnection.on("JoinGroup",t=>{console.log("recieved data from the hub: ",t),this.store.dispatch(u({group:t}))}),this.hubConnection.on("LeaveGroup",t=>{this.store.dispatch(h({group:t}))}),this.hubConnection.on("History",t=>{this.store.dispatch(O({newsItems:t}))}),this.hubConnection.on("Send",t=>{this.store.dispatch(m({newsItem:t}))})}joinGroup(t){this.hubConnection&&this.hubConnection.invoke("JoinGroup",t)}leaveGroup(t){this.hubConnection&&this.hubConnection.invoke("LeaveGroup",t)}getAllGroups(){return this.http.get(rt.a.serverUrl+"/api/news")}send(t){return this.hubConnection&&this.hubConnection.invoke("Send",t),t}}return t.\u0275fac=function(e){return new(e||t)(v.Yb(at.b),v.Yb(Q.a),v.Yb(o.b))},t.\u0275prov=v.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),ht=(()=>{class t{constructor(t,e){this.actions$=t,this.newsService=e,this.joinGroup$=Object(nt.c)(()=>this.actions$.pipe(Object(nt.d)(c),Object(st.a)(t=>(this.newsService.joinGroup(t.group),Object(it.a)(r({group:t.group})))))),this.leaveGroup$=Object(nt.c)(()=>this.actions$.pipe(Object(nt.d)(a),Object(st.a)(t=>(this.newsService.leaveGroup(t.group),Object(it.a)(b({group:t.group})))))),this.getAllGroups$=Object(nt.c)(()=>this.actions$.pipe(Object(nt.d)(p),Object(ot.a)(t=>this.newsService.getAllGroups().pipe(Object(w.a)(t=>g({groups:t})),Object(ct.a)(t=>Object(it.a)(f({error:t}))))))),this.sendNewItem$=Object(nt.c)(()=>this.actions$.pipe(Object(nt.d)(l),Object(st.a)(t=>(this.newsService.send(t.newsItem),Object(it.a)(d({newsItem:t.newsItem}))))))}}return t.\u0275fac=function(e){return new(e||t)(v.Yb(nt.a),v.Yb(bt))},t.\u0275prov=v.Kb({token:t,factory:t.\u0275fac}),t})();var lt=n("hctd");let dt=(()=>{class t{}return t.\u0275mod=v.Mb({type:t}),t.\u0275inj=v.Lb({factory:function(e){return new(e||t)},imports:[[i.c,lt.a,P.i,et,o.d.forFeature(U,k),nt.b.forFeature([ht])]]}),t})()}}]);