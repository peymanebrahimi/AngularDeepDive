(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"9hXf":function(e,t,n){"use strict";n.r(t),n.d(t,"SignalrnewsModule",(function(){return ue}));var s=n("ofXK"),i=n("tyNb"),o=n("l7P3");const r=Object(o.g)("[news] JOIN_GROUP",Object(o.l)()),c=Object(o.g)("[news] JOIN_GROUP_Complete",Object(o.l)()),b=Object(o.g)("[news] RECEIVED_GROUP_JOIN",Object(o.l)()),u=Object(o.g)("[news] LEAVE_GROUP",Object(o.l)()),a=Object(o.g)("[news] LEAVE_GROUP_Complete",Object(o.l)()),l=Object(o.g)("[news] RECEIVED_GROUP_LEFT",Object(o.l)()),d=Object(o.g)("[news] SEND_NEWS_ITEM",Object(o.l)()),h=Object(o.g)("[news] SEND_NEWS_ITEM_COMPLETE",Object(o.l)()),p=Object(o.g)("[news] GET_ALL_GROUPS"),g=Object(o.g)("[news] GET_ALL_GROUPS_Success",Object(o.l)()),f=Object(o.g)("[news] GET_ALL_GROUPS_Failure",Object(o.l)()),O=Object(o.g)("[news] receivedGroupHistory",Object(o.l)()),m=Object(o.g)("[news] receivedItemAction",Object(o.l)());class j{constructor(e,t,n,s){this.header=e,this.newsText=t,this.author=n,this.newsGroup=s}}var w=n("lJxs"),v=n("fXoL");const T=function(){var e={EntitiesOnly:0,Both:1,None:2};return e[e.EntitiesOnly]="EntitiesOnly",e[e.Both]="Both",e[e.None]="None",e}();function C(e){return function(t,n){const s={ids:[...n.ids],entities:Object.assign({},n.entities)},i=e(t,s);return i===T.Both?Object.assign({},n,s):i===T.EntitiesOnly?Object.assign(Object.assign({},n),{entities:s.entities}):n}}function U(e,t){const n=t(e);return Object(v.Y)()&&void 0===n&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",e,"The `selectId` implementation:",t.toString()),n}function I(e){function t(t,n){const s=U(t,e);return s in n.entities?T.None:(n.ids.push(s),n.entities[s]=t,T.Both)}function n(e,n){let s=!1;for(const i of e)s=t(i,n)!==T.None||s;return s?T.Both:T.None}function s(e,t){return t.ids=[],t.entities={},n(e,t),T.Both}function i(e,t){const n=(e instanceof Array?e:t.ids.filter(n=>e(t.entities[n]))).filter(e=>e in t.entities).map(e=>delete t.entities[e]).length>0;return n&&(t.ids=t.ids.filter(e=>e in t.entities)),n?T.Both:T.None}function o(e,t){return r([e],t)}function r(t,n){const s={};return(t=t.filter(e=>e.id in n.entities)).length>0?t.filter(t=>function(t,n,s){const i=Object.assign({},s.entities[n.id],n.changes),o=U(i,e),r=o!==n.id;return r&&(t[n.id]=o,delete s.entities[n.id]),s.entities[o]=i,r}(s,t,n)).length>0?(n.ids=n.ids.map(e=>s[e]||e),T.Both):T.EntitiesOnly:T.None}function c(t,s){const i=[],o=[];for(const n of t){const t=U(n,e);t in s.entities?o.push({id:t,changes:n}):i.push(n)}const c=r(o,s),b=n(i,s);switch(!0){case b===T.None&&c===T.None:return T.None;case b===T.Both||c===T.Both:return T.Both;default:return T.EntitiesOnly}}return{removeAll:function(e){return Object.assign({},e,{ids:[],entities:{}})},addOne:C(t),addMany:C(n),addAll:C(s),setAll:C(s),setOne:C((function(t,n){const s=U(t,e);return s in n.entities?(n.entities[s]=t,T.EntitiesOnly):(n.ids.push(s),n.entities[s]=t,T.Both)})),updateOne:C(o),updateMany:C(r),upsertOne:C((function(e,t){return c([e],t)})),upsertMany:C(c),removeOne:C((function(e,t){return i([e],t)})),removeMany:C(i),map:C((function(e,t){return r(t.ids.reduce((n,s)=>{const i=e(t.entities[s]);return i!==t.entities[s]&&n.push({id:s,changes:i}),n},[]).filter(({id:e})=>e in t.entities),t)})),mapOne:C((function({map:e,id:t},n){const s=n.entities[t];return s?o({id:t,changes:e(s)},n):T.None}))}}const y="newses",G=function(e={}){const{selectId:t,sortComparer:n}=Object.assign({sortComparer:!1,selectId:e=>e.id},e),s={getInitialState:function(e={}){return Object.assign({ids:[],entities:{}},e)}},i={getSelectors:function(e){const t=e=>e.ids,n=e=>e.entities,s=Object(o.j)(t,n,(e,t)=>e.map(e=>t[e])),i=Object(o.j)(t,e=>e.length);return e?{selectIds:Object(o.j)(e,t),selectEntities:Object(o.j)(e,n),selectAll:Object(o.j)(e,s),selectTotal:Object(o.j)(e,i)}:{selectIds:t,selectEntities:n,selectAll:s,selectTotal:i}}},r=n?function(e,t){const{removeOne:n,removeMany:s,removeAll:i}=I(e);function o(e,t){return r([e],t)}function r(t,n){const s=t.filter(t=>!(U(t,e)in n.entities));return 0===s.length?T.None:(l(s,n),T.Both)}function c(e,t){return t.entities={},t.ids=[],r(e,t),T.Both}function b(e,t){return u([e],t)}function u(t,n){const s=[],i=t.filter(t=>function(t,n,s){if(!(n.id in s.entities))return!1;const i=Object.assign({},s.entities[n.id],n.changes),o=U(i,e);return delete s.entities[n.id],t.push(i),o!==n.id}(s,t,n)).length>0;if(0===s.length)return T.None;{const e=n.ids,t=[];return n.ids=n.ids.filter((e,s)=>e in n.entities||(t.push(s),!1)),l(s,n),!i&&t.every(t=>n.ids[t]===e[t])?T.EntitiesOnly:T.Both}}function a(t,n){const s=[],i=[];for(const r of t){const t=U(r,e);t in n.entities?i.push({id:t,changes:r}):s.push(r)}const o=u(i,n),c=r(s,n);switch(!0){case c===T.None&&o===T.None:return T.None;case c===T.Both||o===T.Both:return T.Both;default:return T.EntitiesOnly}}function l(n,s){n.sort(t);const i=[];let o=0,r=0;for(;o<n.length&&r<s.ids.length;){const c=n[o],b=U(c,e),u=s.ids[r];t(c,s.entities[u])<=0?(i.push(b),o++):(i.push(u),r++)}s.ids=i.concat(o<n.length?n.slice(o).map(e):s.ids.slice(r)),n.forEach((t,n)=>{s.entities[e(t)]=t})}return{removeOne:n,removeMany:s,removeAll:i,addOne:C(o),updateOne:C(b),upsertOne:C((function(e,t){return a([e],t)})),addAll:C(c),setAll:C(c),setOne:C((function(t,n){const s=U(t,e);return s in n.entities?(n.ids=n.ids.filter(e=>e!==s),l([t],n),T.Both):o(t,n)})),addMany:C(r),updateMany:C(u),upsertMany:C(a),map:C((function(e,t){return u(t.ids.reduce((n,s)=>{const i=e(t.entities[s]);return i!==t.entities[s]&&n.push({id:s,changes:i}),n},[]),t)})),mapOne:C((function({map:e,id:t},n){const s=n.entities[t];return s?b({id:t,changes:e(s)},n):T.None}))}}(t,n):I(t);return Object.assign(Object.assign(Object.assign({selectId:t,sortComparer:n},s),i),r)}({selectId:e=>e.id}),E=G.getInitialState({groups:[]}),N=Object(o.i)(E,Object(o.k)(g,(e,t)=>Object.assign(Object.assign({},e),{groups:t.groups})),Object(o.k)(b,(e,t)=>{let n=e.groups.indexOf(t.group)>-1?e.groups:e.groups.concat(t.group);return Object.assign(Object.assign({},e),{groups:n})}),Object(o.k)(m,(e,t)=>G.addOne(t.newsItem,e)),Object(o.k)(O,(e,t)=>(console.info("inside reducer: ",t.newsItems),G.setAll(t.newsItems,e))),Object(o.k)(l,(e,t)=>{const n=[];for(const s of e.groups)s!==t.group&&n.push(s);return console.log(n),Object.assign(Object.assign({},e),{groups:n})})),{selectAll:M}=G.getSelectors(),k=Object(o.h)(y),A=Object(o.j)(k,M),S=Object(o.j)(k,e=>e.groups);var B=n("dNgK"),_=n("kmnG"),x=n("d3UM"),L=n("3Pt+"),P=n("qFsG"),R=n("f0Cb"),$=n("FKr1");function F(e,t){if(1&e&&(v.Ub(0,"mat-option",16),v.Cc(1),v.Tb()),2&e){const e=t.$implicit;v.kc("value",e),v.Cb(1),v.Ec("",e," ")}}function J(e,t){if(1&e&&(v.Ub(0,"tr"),v.Ub(1,"td"),v.Cc(2),v.Tb(),v.Ub(3,"td"),v.Cc(4),v.Tb(),v.Ub(5,"td"),v.Cc(6),v.Tb(),v.Ub(7,"td"),v.Cc(8),v.Tb(),v.Ub(9,"td"),v.Cc(10),v.Tb(),v.Tb()),2&e){const e=t.$implicit,n=t.index;v.Cb(2),v.Dc(n+1),v.Cb(2),v.Dc(e.header),v.Cb(2),v.Dc(e.newsText),v.Cb(2),v.Dc(e.author),v.Cb(2),v.Dc(e.newsGroup)}}function D(e,t){1&e&&(v.Ub(0,"div",0),v.Ub(1,"span"),v.Cc(2,"No news items"),v.Tb(),v.Tb())}function Y(e,t){if(1&e&&(v.Sb(0),v.Ub(1,"div",0),v.Ub(2,"div",17),v.Ub(3,"table",18),v.Ub(4,"thead"),v.Ub(5,"tr"),v.Ub(6,"th"),v.Cc(7,"#"),v.Tb(),v.Ub(8,"th"),v.Cc(9,"header"),v.Tb(),v.Ub(10,"th"),v.Cc(11,"Text"),v.Tb(),v.Ub(12,"th"),v.Cc(13,"Author"),v.Tb(),v.Ub(14,"th"),v.Cc(15,"Group"),v.Tb(),v.Tb(),v.Tb(),v.Ub(16,"tbody"),v.Ac(17,J,11,5,"tr",19),v.Tb(),v.Tb(),v.Tb(),v.Tb(),v.Ac(18,D,3,0,"div",20),v.Rb()),2&e){const e=t.ngIf;v.Cb(17),v.kc("ngForOf",e),v.Cb(1),v.kc("ngIf",(null==e?null:e.length)<=0)}}let K=(()=>{class e{constructor(e,t,n){this.store=e,this.snackBar=t,this.route=n,this.group="IT",this.author="chrome",this.newsItem=new j("","",this.author,this.group)}ngOnInit(){this.newsItems$=this.store.select(A),this.groups$=this.route.data.pipe(Object(w.a)(e=>e.groups))}joinGroup(){this.store.dispatch(r({group:this.group}))}leaveGroup(){this.store.dispatch(u({group:this.group}))}sendNewsItemToGroup(){this.store.dispatch(d({newsItem:this.newsItem})),this.newsItem.header="",this.newsItem.newsText=""}}return e.\u0275fac=function(t){return new(t||e)(v.Ob(o.b),v.Ob(B.b),v.Ob(i.a))},e.\u0275cmp=v.Ib({type:e,selectors:[["app-news"]],decls:43,vars:12,consts:[[1,"row"],[1,"col"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","Author","required","",3,"ngModel","ngModelChange"],[1,"col-sm-9"],[1,"btn","btn-primary","col-sm-12","mb-2",3,"click"],[1,"btn","btn-primary","col-sm-12",3,"click"],[1,"form-horizontal",2,"padding","10px 0",3,"ngSubmit"],["newsItemForm","ngForm"],["for","header",1,"col-sm-2","control-label"],["type","text","id","header","placeholder","your header...","name","header","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","newsText",1,"col-sm-2","control-label"],["type","text","id","newsText","placeholder","your newsText...","name","newsText","required","",1,"form-control",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-primary","col-sm-12",3,"disabled"],[4,"ngIf"],[3,"value"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],["class","row",4,"ngIf"]],template:function(e,t){if(1&e&&(v.Ub(0,"div"),v.Ub(1,"div",0),v.Ub(2,"div",1),v.Ub(3,"mat-form-field"),v.Ub(4,"mat-label"),v.Cc(5,"Group"),v.Tb(),v.Ub(6,"mat-select",2),v.ac("ngModelChange",(function(e){return t.group=e})),v.Ac(7,F,2,2,"mat-option",3),v.fc(8,"async"),v.Tb(),v.Tb(),v.Tb(),v.Ub(9,"div",1),v.Ub(10,"mat-form-field"),v.Ub(11,"input",4),v.ac("ngModelChange",(function(e){return t.author=e})),v.Tb(),v.Tb(),v.Tb(),v.Ub(12,"div",1),v.Ub(13,"div",5),v.Ub(14,"button",6),v.ac("click",(function(){return t.joinGroup()})),v.Cc(15,"Join"),v.Tb(),v.Ub(16,"button",7),v.ac("click",(function(){return t.leaveGroup()})),v.Cc(17,"Leave"),v.Tb(),v.Tb(),v.Tb(),v.Tb(),v.Tb(),v.Pb(18,"mat-divider"),v.Ub(19,"form",8,9),v.ac("ngSubmit",(function(){return t.sendNewsItemToGroup()})),v.Ub(21,"div",0),v.Ub(22,"div",1),v.Ub(23,"label",10),v.Cc(24,"Header"),v.Tb(),v.Ub(25,"div",5),v.Ub(26,"input",11),v.ac("ngModelChange",(function(e){return t.newsItem.header=e})),v.Tb(),v.Tb(),v.Tb(),v.Ub(27,"div",1),v.Ub(28,"label",12),v.Cc(29,"Text"),v.Tb(),v.Ub(30,"div",5),v.Ub(31,"input",13),v.ac("ngModelChange",(function(e){return t.newsItem.newsText=e})),v.Tb(),v.Tb(),v.Tb(),v.Ub(32,"div",1),v.Pb(33,"label",12),v.Ub(34,"div",5),v.Ub(35,"button",14),v.Cc(36),v.Tb(),v.Tb(),v.Tb(),v.Tb(),v.Tb(),v.Pb(37,"br"),v.Pb(38,"br"),v.Pb(39,"mat-divider"),v.Pb(40,"br"),v.Ac(41,Y,19,2,"ng-container",15),v.fc(42,"async")),2&e){const e=v.qc(20);v.Cb(6),v.kc("ngModel",t.group),v.Cb(1),v.kc("ngForOf",v.gc(8,8,t.groups$)),v.Cb(4),v.kc("ngModel",t.author),v.Cb(15),v.kc("ngModel",t.newsItem.header),v.Cb(5),v.kc("ngModel",t.newsItem.newsText),v.Cb(4),v.kc("disabled",!e.valid),v.Cb(1),v.Ec("Send News to: ",t.group,""),v.Cb(5),v.kc("ngIf",v.gc(42,10,t.newsItems$))}},directives:[_.c,_.f,x.a,L.m,L.p,s.m,P.b,L.c,L.r,R.a,L.t,L.n,L.o,s.n,$.n],pipes:[s.b],styles:[""]}),e})();var q=n("vkgz"),V=n("pLZG"),H=n("SxV6"),X=n("nYR2");const z=[{path:"",component:K,resolve:{groups:(()=>{class e{constructor(e){this.store=e,this.isBusy=!1}resolve(e,t){return this.store.pipe(Object(o.m)(S),Object(q.a)(e=>{this.isBusy||0!=e.length||(this.isBusy=!0,this.store.dispatch(p()))}),Object(V.a)(e=>e.length>0),Object(H.a)(),Object(X.a)(()=>this.isBusy=!1))}}return e.\u0275fac=function(t){return new(t||e)(v.Yb(o.b))},e.\u0275prov=v.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}];let W=(()=>{class e{}return e.\u0275mod=v.Mb({type:e}),e.\u0275inj=v.Lb({factory:function(t){return new(t||e)},imports:[[i.j.forChild(z)],i.j]}),e})();var Z=n("9jGm"),Q=n("LRne"),ee=n("eIep"),te=n("bOdf"),ne=n("JIr8"),se=n("AytR"),ie=n("Gpoy"),oe=n("tk/3");let re=(()=>{class e{constructor(e,t){this.http=e,this.store=t,this.hubConnection=(new ie.a).withUrl(se.a.serverUrl+"/news").configureLogging(se.a.production?ie.b.None:ie.b.Information).build(),this.registerEvents(),this.connect()}connect(){this.hubConnection.start().then(()=>console.log("Connection started")).catch(e=>console.log("Error while starting connection: ",e))}disconnect(){this.hubConnection.stop().catch(e=>console.log("Error while stopping connection: ",e))}registerEvents(){this.hubConnection.on("JoinGroup",e=>{console.log("recieved data from the hub: ",e),this.store.dispatch(b({group:e}))}),this.hubConnection.on("LeaveGroup",e=>{this.store.dispatch(l({group:e}))}),this.hubConnection.on("History",e=>{this.store.dispatch(O({newsItems:e}))}),this.hubConnection.on("Send",e=>{this.store.dispatch(m({newsItem:e}))})}joinGroup(e){this.hubConnection&&this.hubConnection.invoke("JoinGroup",e)}leaveGroup(e){this.hubConnection&&this.hubConnection.invoke("LeaveGroup",e)}getAllGroups(){return this.http.get(se.a.serverUrl+"/api/news")}send(e){return this.hubConnection&&this.hubConnection.invoke("Send",e),e}}return e.\u0275fac=function(t){return new(t||e)(v.Yb(oe.b),v.Yb(o.b))},e.\u0275prov=v.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),ce=(()=>{class e{constructor(e,t){this.actions$=e,this.newsService=t,this.joinGroup$=Object(Z.c)(()=>this.actions$.pipe(Object(Z.d)(r),Object(ee.a)(e=>(this.newsService.joinGroup(e.group),Object(Q.a)(c({group:e.group})))))),this.leaveGroup$=Object(Z.c)(()=>this.actions$.pipe(Object(Z.d)(u),Object(ee.a)(e=>(this.newsService.leaveGroup(e.group),Object(Q.a)(a({group:e.group})))))),this.getAllGroups$=Object(Z.c)(()=>this.actions$.pipe(Object(Z.d)(p),Object(te.a)(e=>this.newsService.getAllGroups().pipe(Object(w.a)(e=>g({groups:e})),Object(ne.a)(e=>Object(Q.a)(f({error:e}))))))),this.sendNewItem$=Object(Z.c)(()=>this.actions$.pipe(Object(Z.d)(d),Object(ee.a)(e=>(this.newsService.send(e.newsItem),Object(Q.a)(h({newsItem:e.newsItem}))))))}}return e.\u0275fac=function(t){return new(t||e)(v.Yb(Z.a),v.Yb(re))},e.\u0275prov=v.Kb({token:e,factory:e.\u0275fac}),e})();var be=n("hctd");let ue=(()=>{class e{}return e.\u0275mod=v.Mb({type:e}),e.\u0275inj=v.Lb({factory:function(t){return new(t||e)},imports:[[s.c,be.a,L.i,W,o.d.forFeature(y,N),Z.b.forFeature([ce])]]}),e})()}}]);